
(
x:info "下载 git@github.com:x-cmd-advise/x-cmd-advise"
git clone git@github.com:x-cmd-advise/x-cmd-advise


cd x-cmd-advise || return
mkdir -p src
xws --cat all | while read -r repo; do
    x:info "assemble src/$repo"
    if [ -d "src/$repo" ]; then
        git subtree pull --prefix "src/$repo" --squash git@github.com:x-cmd-advise/$repo main || {
            x:error "Failed to git subtree pull src/$repo"
        }
    else
        git subtree add --prefix "src/$repo" --squash git@github.com:x-cmd-advise/$repo main
    fi
done

x:info "提交并推送 x-cmd-advise/x-cmd-advise"
git commit -m ...
git push

)

